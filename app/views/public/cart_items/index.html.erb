<!-- nagano_view_pablic_cart_items_index -->
 
<h1>pablic_cart_items_index_カート内商品一覧画面(カート表示画面)</h1>
  
  
    <!-- フラッシュメッセージ投稿成功時 -->
  <div>
    <%= flash[:notice] %>
  </div>
  
  <main>
    <div class="container">
      <div class="row">
        <div class="mx-auto auto col-11 col-sm10 col-lg col-xl-9">
        
          <h3>カート内商品一覧画面</h3>
          
          <h4>ショッピングカート</h4>
          
            <!-- 全てのカート情報削除〇 -->
          <string>
            <%= link_to 'カートを空にする', cart_items_destroy_all_path, class:"btn btn-danger", method: :delete %>
          </string>
          
              <!-- ショッピングカート -->
          <table border="1" width="900"  height="100">
                <!-- 商品名,単価,数量,小計△ -->
                <!-- 表示制限の記述 -->
            <% if @cart_items.exists? %>
              <thead>
                <tr>
                  <th>商品名</th>
                  <th>単価(税込み)</th>
                  <th>数量</th>
                  <th>小計</th>
                </tr>
              </thead>
            <% end %>
                <!-- 合計金額を出すために o 円を設定? -->
              <% @sum = 0 %>
                <!-- 商品画像,商品名,価格,個数,小計,合計 -->
            <tbody>
              <% @cart_items.each do |cart_item| %>
                  <!-- 商品一覧表示△ -->
                <tr align="left">
                    <!-- 商品画像,商品名〇 -->
                  <td>
                    <%= image_tag cart_item.item.get_image, size: "100x70" %>
                      <!-- cart_item.送信データ.name -->
                    <%= cart_item.item.name %>
                  </td>
                    <!-- 単価(税込),価格〇 -->
                  <td>
                    <%= cart_item.item.with_tax_price %>
                  </td>
                    <!-- 数量の個数〇 -->
                  <td>
                    <%= form_with model: cart_item, url: cart_item_path(cart_item) do |f| %>
                        <!-- 商品個数 -->
                      <%= f.number_field :quantity %>
                        <!-- チェックボックス -->
                      <%= f.submit '変更', class:"btn btn-success" %>
                    <% end %>
                  </td>
                    <!-- 商品の単一小計価格〇 -->
                  <td>
                      <!-- 商品単一合計価格 -->
                    <%= cart_item.subtotal%>
                  </td>
                    <!-- 商品削除〇 -->
                  <td>
                    <%= link_to '削除する', cart_item_path(cart_item), class:"btn btn-danger", method: :delete %>
                  </td>
                    <!-- 商品の合計価格算出場所〇  -->
                    <!-- !!全ての単一商品の合計値を出すために記述しておく,無いと合計が出ない!! -->
                  <% @sum += cart_item.subtotal %>
                  
                </tr>
              <% end %>
            
            </tbody>
                  
          </table>
              <!-- 買い物,合計金額 -->
          <table align="right" border="1" width="230"  height="50">
            
              <!-- 買い物を続ける〇 -->
            <div align="left">
              <%= link_to '買い物を続ける', root_path, class:"btn btn-primary" %>
            </div>
              <!-- 合計金額 -->
              <!-- 表示制限の記述 -->
            <% if @cart_items.exists? %>
              <th>
                <label for="introduction">合計金額</label>
              </th>
              <th>
                <%= @sum %>
              </th>
            <% end %>
          </table>
              <!-- 情報入力に進む〇 -->
          <table align="center" width="900"  height="50">
            
            <th align="left" width="330"  height="50"></th>
              <!-- @cart_items にデータが無い時表示を制限する -->
              <!-- 情報入力に進む,表示制限 true,false 済〇 -->
            <td>
              <% if @cart_items.exists? %>
                <%= link_to '情報入力に進む', new_order_path, class:"btn btn-success" %>
              <% end %>
            </td>
          
          </table>
          
        </div>
      </div>
    </div>
  </main>

